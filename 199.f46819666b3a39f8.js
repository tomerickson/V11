"use strict";(self.webpackChunkv11=self.webpackChunkv11||[]).push([[199],{1199:(D,v,t)=>{t.r(v),t.d(v,{ALL_RESULTS_ROUTES:()=>X});var p={};t.r(p),t.d(p,{fetchAllResultsErrorAlert:()=>H,loadAllResultsEffect:()=>P,refreshAllResultsEffect:()=>z});var n=t(7483),a=t(4221),f=t(8675),C=t(2678),r=t(5879),m=t(4664),i=t(7398),h=t(6306),A=t(2096),F=t(9397);const u=(0,a.R7)({source:"AllResults API",events:{Reset:(0,a.uZ)(),loadResults:(0,a.Ky)(),loadResultsSuccess:(0,a.Ky)(),loadResultsFailure:e=>({error:e}),refreshResults:(0,a.Ky)()}});var E=t(2744),M=t(2401);class T extends M.C{constructor(s,o){super(s,o,1)}}var x=t(5281),U=t(6414),L=t(8045);let c=(()=>{var e;class s{constructor(){this.config=(0,r.f3M)(x._),this.crud=(0,r.f3M)(U.I),this.page="list-results.php",this.getAllResultsPage=()=>this.crud.getPage(this.page),this.refreshResults=l=>{const d=new FormData;d.append("doit","refresh"),d.append("order",l);const S=(0,L.Fj)(d);return this.crud.postPage(this.page,S)},this.extractResultsTable=l=>{const j=(new DOMParser).parseFromString(l,"text/html").body.querySelector("table.results").rows[0].cells[0].innerText;return new T(l,[j])}}}return(e=s).\u0275fac=function(l){return new(l||e)},e.\u0275prov=r.Yz7({token:e,factory:e.\u0275fac}),s})();const P=(0,n.GW)((e=(0,r.f3M)(n.eX))=>{const s=(0,r.f3M)(c);return e.pipe((0,n.l4)(u.loadResults),(0,m.w)(()=>s.getAllResultsPage().pipe((0,i.U)(o=>s.extractResultsTable(o)),(0,i.U)(o=>u.loadResultsSuccess({payload:o})),(0,h.K)(o=>(0,A.of)(u.loadResultsFailure({error:o}))))))},{functional:!0}),z=(0,n.GW)((e=(0,r.f3M)(n.eX))=>{const s=(0,r.f3M)(c);return e.pipe((0,n.l4)(u.refreshResults),(0,m.w)(o=>s.refreshResults(o.sort).pipe((0,i.U)(l=>s.extractResultsTable(l)),(0,i.U)(l=>u.loadResultsSuccess({payload:l})),(0,h.K)(l=>(0,A.of)(u.loadResultsFailure({error:l}))))))},{functional:!0}),H=(0,n.GW)(()=>{const e=(0,r.f3M)(E.c);return(0,r.f3M)(n.eX).pipe((0,n.l4)(u.loadResultsFailure),(0,F.b)(()=>e.showClientError("No results found.")))},{functional:!0,dispatch:!1}),g={query:"",loading:!1,ready:!1,error:null,results:[]},K=(0,a.Lq)(g,(0,a.on)(u.reset,()=>({...g})),(0,a.on)(u.loadResults,(e,s)=>({...e,query:s.query,loading:!0,ready:!1,error:null,results:[]})),(0,a.on)(u.loadResultsSuccess,(e,s)=>({...e,ready:!0,loading:!1,results:s.payload.reactionResults})),(0,a.on)(u.loadResultsFailure,(e,s)=>({...e,loading:!1,error:s.error}))),R=(0,a.Tz)({name:"all-results",reducer:K,extraSelectors:({selectResults:e})=>({selectRows:(0,a.P1)(e,s=>s.length)})});var y=t(6814);let O=(()=>{var e;class s{}return(e=s).\u0275fac=function(l){return new(l||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["mfmp-all-results-face"]],standalone:!0,features:[r.jDz],decls:2,vars:0,template:function(l,d){1&l&&(r.TgZ(0,"p"),r._uU(1,"all-results-face works!"),r.qZA())},dependencies:[y.ez]}),s})();const X=[{path:"",component:(()=>{var e;class s{constructor(){this.store=(0,r.f3M)(a.yh),this.headerService=(0,r.f3M)(f.d)}ngOnInit(){this.headerService.buildPageHeader("all-results")}}return(e=s).\u0275fac=function(l){return new(l||e)},e.\u0275cmp=r.Xpm({type:e,selectors:[["mfmp-all-results-head"]],standalone:!0,features:[r.jDz],decls:1,vars:0,template:function(l,d){1&l&&r._UZ(0,"mfmp-all-results-face")},dependencies:[y.ez,O],encapsulation:2}),s})(),providers:[(0,a.oY)(R),(0,n.y3)([p]),{provide:c,useClass:c},{provide:f.d,useClass:f.d}]},{path:"reports",component:C.a,providers:[(0,a.oY)(R),(0,n.y3)([p]),{provide:c,useClass:c},{provide:f.d,useClass:f.d}]}]}}]);